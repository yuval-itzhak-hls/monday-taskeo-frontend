import{slicedToArray as e,defineProperty as n,toConsumableArray as o}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{getTestId as t,ComponentDefaultTestId as r}from"../../tests/testIds.js";import i from"classnames";import{BaseSizes as a}from"../../constants/sizes.js";import s,{forwardRef as l,useRef as u,useMemo as c,useState as d,useEffect as p,useCallback as m}from"react";import f,{createFilter as v,components as O}from"react-select";import b from"react-select/async";import g from"react-select/base";import{noop as j}from"lodash-es";import C from"./components/menu/menu.js";import M from"./components/DropdownIndicator/DropdownIndicator.js";import y from"./components/option/option.js";import h from"./components/singleValue/singleValue.js";import w from"./components/ClearIndicator/ClearIndicator.js";import S from"./components/MultiValueContainer/MultiValueContainer.js";import{isClient as I}from"../../utils/ssr-utils.js";import{DROPDOWN_CHIP_COLORS as V,DROPDOWN_MENU_PLACEMENT as D,DROPDOWN_MENU_POSITION as R,ADD_AUTO_HEIGHT_COMPONENTS as P,defaultCustomStyles as W,DROPDOWN_ID as A,DROPDOWN_MENU_ID as L,DROPDOWN_MENU_ARIA_LABEL as x,DROPDOWN_INPUT_ARIA_LABEL as z}from"./DropdownConstants.js";import E,{customTheme as N}from"./Dropdown.styles.js";import F from"./components/Control/Control.js";import T from"./components/menu/menu.module.scss.js";import B from"./Dropdown.module.scss.js";import{withStaticProps as k}from"../../types/withStaticProps.js";import"../../utils/colors-vars-map.js";var q=k(l((function(a,l){var v=a.className,V=a.optionWrapperClassName,D=a.singleValueWrapperClassName,R=a.dropdownMenuWrapperClassName,k=a.placeholder,q=void 0===k?"":k,H=a.disabled,G=void 0!==H&&H,K=a.readOnly,_=void 0!==K&&K,J=a.onMenuOpen,Q=void 0===J?j:J,U=a.onMenuClose,X=void 0===U?j:U,Y=a.onFocus,Z=void 0===Y?j:Y,$=a.onBlur,ee=void 0===$?j:$,ne=a.onScroll,oe=void 0===ne?j:ne,te=a.onMenuScrollToBottom,re=void 0===te?j:te,ie=a.onChange,ae=void 0===ie?j:ie,se=a.searchable,le=void 0===se||se,ue=a.captureMenuScroll,ce=void 0!==ue&&ue,de=a.options,pe=void 0===de?[]:de,me=a.defaultValue,fe=a.value,ve=a.noOptionsMessage,Oe=a.openMenuOnFocus,be=a.openMenuOnClick,ge=a.clearable,je=void 0===ge||ge,Ce=a.OptionRenderer,Me=a.optionRenderer,ye=a.ValueRenderer,he=a.valueRenderer,we=a.menuRenderer,Se=a.menuPlacement,Ie=void 0===Se?"bottom":Se,Ve=a.rtl,De=a.size,Re=void 0===De?"medium":De,Pe=a.asyncOptions,We=a.cacheOptions,Ae=a.defaultOptions,Le=a.isVirtualized,xe=a.menuPortalTarget,ze=a.extraStyles,Ee=void 0===ze?W:ze,Ne=a.maxMenuHeight,Fe=a.menuIsOpen,Te=a.tabIndex,Be=void 0===Te?"0":Te,ke=a.id,qe=void 0===ke?A:ke,He=a.menuId,Ge=void 0===He?L:He,Ke=a.menuAriaLabel,_e=void 0===Ke?x:Ke,Je=a.inputAriaLabel,Qe=void 0===Je?z:Je,Ue=a.autoFocus,Xe=void 0!==Ue&&Ue,Ye=a.multi,Ze=void 0!==Ye&&Ye,$e=a.multiline,en=void 0!==$e&&$e,nn=a.onOptionRemove,on=a.onOptionSelect,tn=a.onClear,rn=a.onInputChange,an=void 0===rn?j:rn,sn=a.closeMenuOnSelect,ln=void 0===sn?!Ze:sn,un=a.closeMenuOnScroll,cn=void 0!==un&&un,dn=a.withMandatoryDefaultOptions,pn=void 0!==dn&&dn,mn=a.isOptionSelected,fn=a.insideOverflowContainer,vn=void 0!==fn&&fn,On=a.insideOverflowWithTransformContainer,bn=void 0!==On&&On,gn=a.tooltipContent,jn=void 0===gn?"":gn,Cn=a.onKeyDown,Mn=void 0===Cn?j:Cn,yn=a.isLoading,hn=void 0!==yn&&yn,wn=a.loadingMessage,Sn=a.ariaLabel,In=a.tabSelectsValue,Vn=void 0===In||In,Dn=a.popupsContainerSelector,Rn=a.filterOption,Pn=a.menuPosition,Wn=void 0===Pn?"absolute":Pn,An=a["data-testid"],Ln=a.withGroupDivider,xn=void 0!==Ln&&Ln,zn=a.inputValue,En=a.blurInputOnSelect,Nn=u(),Fn=xe||Dn&&document.querySelector(Dn),Tn=c((function(){return me?Array.isArray(me)?me.map((function(e){return Object.assign(Object.assign({},e),{isMandatory:!0})})):Object.assign(Object.assign({},me),{isMandatory:!0}):me}),[me]);g.prototype.renderLiveRegion=function(){return null};var Bn=d(null),kn=e(Bn,2),qn=kn[0],Hn=kn[1];p((function(){if(I()){var e=!1;try{e="function"==typeof require&&"undefined"!=typeof module}catch(n){e=!1}if(e){var n=require("react-windowed-select");Hn((function(){return n.WindowedMenuList}))}else import("react-windowed-select").then((function(e){Hn((function(){return e.WindowedMenuList}))}))}}),[]);var Gn=d(Tn||[]),Kn=e(Gn,2),_n=Kn[0],Jn=Kn[1],Qn=d(""),Un=e(Qn,2),Xn=Un[0],Yn=Un[1],Zn=Me||Ce,$n=he||ye,eo=!!fe,no=null!=fe?fe:_n,oo=c((function(){return Array.isArray(no)?no.reduce((function(e,o){return Object.assign(Object.assign({},e),n({},o.value,o))}),{}):{}}),[no]),to=c((function(){return Sn||"".concat(_?"Readonly ":""," ").concat(jn," ").concat(Array.isArray(no)?"Selected: ".concat(no.map((function(e){return e.label})).join(", ")):"Select")}),[Sn,_,no,jn]),ro=Ze?no:fe,io=c((function(){var o=E({size:Re,rtl:Ve,insideOverflowContainer:vn,controlRef:Nn,insideOverflowWithTransformContainer:bn,withGroupDivider:xn,searchable:le}),t=Ee(o),r=Object.entries(t).reduce((function(t,r){var i=e(r,2),a=i[0],s=i[1];return Object.assign(Object.assign({},t),n({},a,(function(e,n){var t=o[a],r=t?t(e,n):e;return s(r,n)})))}),{});if(Ze){en&&P.forEach((function(e){var n=r[e];r[e]=function(e,o){return Object.assign(Object.assign({},n(e,o)),{height:"auto"})}}));var i=r.valueContainer;r.valueContainer=function(e,n){return Object.assign(Object.assign({},i(e,n)),{paddingLeft:6})}}return r}),[Re,Ve,vn,bn,Ee,Ze,en]),ao=m((function(e){return s.createElement(C,Object.assign({},e,{id:Ge,ariaLabel:_e,Renderer:we,dropdownMenuWrapperClassName:R,onScroll:oe}))}),[R,we,Ge,_e,oe]),so=m((function(e){return s.createElement(M,Object.assign({},e,{size:Re}))}),[Re]),lo=m((function(e){return s.createElement(y,Object.assign({setFocusedOptionId:Yn},e,{Renderer:Zn,optionWrapperClassName:V}))}),[Zn,V,Yn]),uo=m((function(e){var n=e.selectProps,o=n.focusedOptionId,t=n.menuIsOpen;return s.createElement(O.Input,Object.assign({},e,{"aria-activedescendant":o&&t?o:"",role:"combobox","aria-expanded":!_&&t,"aria-label":Qe,"aria-controls":Ge,readOnly:!le||void 0}))}),[Ge,_]),co=m((function(e){return s.createElement(h,Object.assign({},e,{readOnly:_,Renderer:$n,selectedOption:no[0],singleValueWrapperClassName:D}))}),[$n,_,no,D]),po=m((function(e){return s.createElement(w,Object.assign({},e,{size:Re}))}),[Re]),mo=c((function(){return function(e,n){nn&&nn(oo[e]);var o=Array.isArray(no)?no.filter((function(n){return n.value!==e})):no;ae&&ae(o,n),Jn(o)}}),[ae,nn,no,oo]),fo=c((function(){return{selectedOptions:no,onSelectedDelete:mo,isMultiline:en,insideOverflowContainer:vn,insideOverflowWithTransformContainer:bn,controlRef:Nn,tooltipContent:jn,popupsContainerSelector:Dn,size:Re}}),[no,mo,en,vn,bn,jn,Dn,Re]),vo=Pe?b:f;vo=vo.default||vo;var Oo=Object.assign({},Pe&&Object.assign({loadOptions:Pe,cacheOptions:We},Ae&&{defaultOptions:Ae})),bo=Object.assign(Object.assign({},!Pe&&{options:pe}),Ze&&{isMulti:!0}),go=m((function(e){var n,o=e.target;return!(null===(n=null==o?void 0:o.parentElement)||void 0===n?void 0:n.classList.contains(T.dropdownMenuWrapper))&&(cn||vn||bn)}),[vn,bn,cn]);return s.createElement(vo,Object.assign({className:i(B.dropdown,v),selectProps:fo,components:Object.assign(Object.assign({DropdownIndicator:so,Menu:ao,ClearIndicator:po,Input:uo,Option:lo,Control:F,SingleValue:co},Ze&&{MultiValue:j,ValueContainer:S}),Le&&qn&&{MenuList:qn}),closeMenuOnScroll:go,size:Re,noOptionsMessage:ve,placeholder:q,isDisabled:G,isClearable:!_&&je,isSearchable:!_,readOnly:_,"aria-readonly":_,"aria-label":to,"aria-details":jn,"aria-haspopup":"listbox",defaultValue:me,value:ro,onMenuOpen:Q,onMenuClose:X,onFocus:Z,onBlur:ee,onMenuScrollToBottom:re,captureMenuScroll:ce,onChange:function(e,n){switch(ae&&ae(e,n),n.action){case"select-option":var t=Ze?n.option:e;on&&on(t),eo||Jn([].concat(o(no),[t]));break;case"clear":tn&&tn(),eo||Jn(pn?Tn:[])}},onKeyDown:Mn,onInputChange:an,openMenuOnFocus:Oe,openMenuOnClick:be,focusedOptionId:Xn,isRtl:Ve,styles:io,theme:N,maxMenuHeight:Ne,menuPortalTarget:Fn,menuPlacement:Ie,menuPosition:Wn,menuIsOpen:!_&&Fe,tabIndex:Be,id:qe,"data-testid":An||t(r.DROPDOWN,qe),autoFocus:Xe,closeMenuOnSelect:ln,ref:l,withMandatoryDefaultOptions:pn,isOptionSelected:mn,isLoading:hn,loadingMessage:wn,tabSelectsValue:Vn,filterOption:Rn,inputValue:zn,blurInputOnSelect:En},Oo,bo))})),{sizes:a,chipColors:V,menuPlacements:D,menuPositions:R,createFilter:v});export{q as default};
//# sourceMappingURL=Dropdown.js.map
