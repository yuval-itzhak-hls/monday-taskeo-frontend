import{slicedToArray as t}from"../../../_virtual/_rollupPluginBabelHelpers.js";import e from"classnames";import r,{forwardRef as i,useRef as n,useState as s,useCallback as o,useEffect as a,useMemo as l}from"react";import c from"../../hooks/useMergeRef.js";import u from"../../hooks/useKeyEvent/index.js";import{VirtualizedListItems as m}from"./VirtualizedListItems/VirtualizedListItems.js";import{keyCodes as d,UP_DOWN_ARROWS as f}from"../../constants/keyCodes.js";import{withStaticProps as p}from"../../types/withStaticProps.js";import"../../utils/colors-vars-map.js";import{ListWrapperComponentType as v}from"./ListConstants.js";import{getTestId as y,ComponentDefaultTestId as b}from"../../tests/testIds.js";import{ListContext as j}from"./utils/ListContext.js";import{useListId as I,getListItemIndexById as L,getNextListItemIndex as x,getPrevListItemIndex as h,getListItemIdByIndex as k,isListItem as A,getListItemComponentType as E}from"./utils/ListUtils.js";import g from"./List.module.scss.js";var R=i((function(i,p){var v=i.className,C=i.id,O=i.component,P=void 0===O?R.components.UL:O,V=i.children,_=i.ariaLabel,D=i.ariaDescribedBy,N=i["aria-controls"],T=i.renderOnlyVisibleItems,U=void 0!==T&&T,W=i.style,z=i["data-testid"],B=n(null),H=c(p,B),M=n([]),S=I(C),w=s(0),F=t(w,2),K=F[0],q=F[1],G=P,J=o((function(t){var e;q(L(M,t)),null===(e=null==B?void 0:B.current)||void 0===e||e.setAttribute("aria-activedescendant",t)}),[]),Q=o((function(t){if(!U){t.preventDefault();var e=t.key===d.UP_ARROW,r=void 0;t.key===d.DOWN_ARROW&&M.current.length>K+1?r=x(K,M):e&&K>0&&(r=h(K,M)),void 0!==r&&(J(k(M,r)),M.current[r].focus())}}),[K,U,J]);u({keys:f,callback:Q,ref:B}),a((function(){var t=M.current.findIndex((function(t){return t instanceof HTMLElement&&A(t)&&"true"===(null==t?void 0:t.getAttribute("aria-selected"))}));if(-1!==t)J(k(M,t));else{var e=M.current.findIndex((function(t){return A(t)}));-1!==e&&J(k(M,e))}}),[J]);var X=l((function(){var t=Array.isArray(V)?V:[V];return U?t=r.createElement(m,null,t):(M.current=M.current.slice(0,t.length),t=r.Children.map(t,(function(t,e){if(!r.isValidElement(t))return t;var i=t.props.id||"".concat(S,"-item-").concat(e),n=M.current[e],s=null==n||A(n);return r.cloneElement(t,{ref:function(t){return M.current[e]=t},tabIndex:K===e&&s?0:-1,id:i,component:E(P)})}))),t}),[V,P,K,S,U]);return r.createElement(j.Provider,{value:{updateFocusedItem:J}},r.createElement(G,{"data-testid":z||y(b.LIST,C),ref:H,style:W,className:e(g.list,v),id:S,"aria-label":_,"aria-describedby":D,"aria-controls":N,tabIndex:-1,role:"listbox"},X))})),C=p(R,{components:v});export{C as default};
//# sourceMappingURL=List.js.map
