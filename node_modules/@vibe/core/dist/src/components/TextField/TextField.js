import{slicedToArray as e,defineProperty as t}from"../../../_virtual/_rollupPluginBabelHelpers.js";import o from"classnames";import a,{forwardRef as n,useState as r,useRef as i,useCallback as l,useMemo as s,useEffect as c}from"react";import d from"../../hooks/useDebounceEvent/index.js";import m from"../Icon/Icon.js";import u from"../Loader/Loader.js";import p from"../Text/Text.js";import v from"../FieldLabel/FieldLabel.js";import{TextFieldFeedbackState as f,TextFieldTextType as C,FEEDBACK_CLASSES as b,SIZE_MAPPER as x,TextFieldAriaLabel as y}from"./TextFieldConstants.js";import{BASE_SIZES as E}from"../../constants/sizes.js";import T from"../../hooks/useMergeRef.js";import N from"../Clickable/Clickable.js";import{getTestId as h}from"../../tests/testIds.js";import{NOOP as g}from"../../utils/function-utils.js";import{ComponentDefaultTestId as I}from"../../tests/constants.js";import{withStaticProps as j}from"../../types/withStaticProps.js";import"../../utils/colors-vars-map.js";import F from"./TextField.module.scss.js";import L from"../Tooltip/Tooltip.js";import k from"../HiddenText/HiddenText.js";var w={primary:"",secondary:""},D=j(n((function(n,f){var C=n.className,E=void 0===C?"":C,j=n.placeholder,D=void 0===j?"":j,H=n.autoComplete,A=void 0===H?"off":H,S=n.value,q=n.onChange,R=void 0===q?g:q,W=n.onBlur,_=void 0===W?g:W,z=n.onFocus,B=void 0===z?g:z,O=n.onKeyDown,K=void 0===O?g:O,M=n.onWheel,P=void 0===M?g:M,V=n.debounceRate,U=void 0===V?0:V,X=n.autoFocus,Y=void 0!==X&&X,G=n.disabled,J=void 0!==G&&G,Q=n.readonly,Z=void 0!==Q&&Q,$=n.setRef,ee=void 0===$?g:$,te=n.iconName,oe=n.secondaryIconName,ae=n.id,ne=void 0===ae?"input":ae,re=n.title,ie=void 0===re?"":re,le=n.size,se=void 0===le?"small":le,ce=n.validation,de=void 0===ce?null:ce,me=n.wrapperClassName,ue=void 0===me?"":me,pe=n.onIconClick,ve=void 0===pe?g:pe,fe=n.clearOnIconClick,Ce=void 0!==fe&&fe,be=n.labelIconName,xe=n.showCharCount,ye=void 0!==xe&&xe,Ee=n.inputAriaLabel,Te=n.searchResultsContainerId,Ne=void 0===Te?"":Te,he=n.activeDescendant,ge=void 0===he?"":he,Ie=n.iconsNames,je=void 0===Ie?w:Ie,Fe=n.type,Le=void 0===Fe?"text":Fe,ke=n.maxLength,we=void 0===ke?null:ke,De=n.allowExceedingMaxLength,He=void 0!==De&&De,Ae=n.trim,Se=void 0!==Ae&&Ae,qe=n.role,Re=void 0===qe?"":qe,We=n.required,_e=void 0!==We&&We,ze=n.requiredErrorText,Be=void 0===ze?"":ze,Oe=n.loading,Ke=void 0!==Oe&&Oe,Me=n["data-testid"],Pe=n.secondaryDataTestId,Ve=n.tabIndex,Ue=n.underline,Xe=void 0!==Ue&&Ue,Ye=n.name,Ge=n.controlled,Je=void 0!==Ge&&Ge,Qe=n.iconTooltipContent,Ze=n.secondaryTooltipContent,$e=n.dir,et=r(!1),tt=e(et,2),ot=tt[0],at=tt[1],nt=i(null),rt=T(f,nt,ee),it=l((function(e){_e&&!e.target.value&&at(!0),_(e)}),[_,_e]),lt=l((function(e,t){ot&&e&&at(!1),R(e,t||{target:nt.current})}),[R,ot]),st=d({delay:U,onChange:lt,initialStateValue:S,trim:Se}),ct=st.inputValue,dt=st.onEventChanged,mt=st.clearValue,ut=s((function(){return Je?S:ct}),[Je,S,ct]),pt=l((function(e){Je?lt(e.target.value,e):dt(e)}),[Je,lt,dt]),vt=s((function(){return oe&&ut?oe:te}),[te,oe,ut]),ft=l((function(){J||(Ce&&(nt.current&&nt.current.focus(),nt.current.value="",Je?lt(""):mt()),ve(vt))}),[J,Ce,ve,vt,Je,lt,mt]),Ct=s((function(){return"number"==typeof we&&ut&&ut.length>we?b.error:de&&de.status||ot?b[ot?"error":de.status]:""}),[we,de,ot,ut]),bt=te||oe,xt=ye||de&&de.text||ot,yt=oe===vt,Et=te===vt,Tt=(ve!==g||je.primary||Qe)&&ut&&te.length&&Et,Nt=(oe||Ze)&&yt&&!!ut,ht=He?"".concat(ne,"-allow-exceeding-max-length-text"):void 0;c((function(){if((null==nt?void 0:nt.current)&&Y){var e=requestAnimationFrame((function(){return nt.current.focus()}));return function(){return cancelAnimationFrame(e)}}}),[nt,Y]);var gt=ve!==g||Ce,It=je.primary||Qe,jt=je.secondary||Ze;return a.createElement("div",{className:o(F.textField,ue,t(t({},F.disabled,J),F.onlyUnderline,Xe)),role:Re,"aria-busy":Ke},a.createElement("div",{className:o(F.labelWrapper)},a.createElement(v,{labelText:ie,icon:be,labelFor:ne,required:_e}),a.createElement("div",{className:o(F.inputWrapper,x[se],Ct)},a.createElement("input",{className:o(E,F.input,t(t({},F.inputHasIcon,!!bt),F.readOnly,Z)),placeholder:D,autoComplete:A,value:ut,onChange:pt,disabled:J,readOnly:Z,ref:rt,type:Le,id:ne,"data-testid":Me||h(I.TEXT_FIELD,ne),name:Ye,onBlur:it,onFocus:B,onKeyDown:K,onWheel:P,maxLength:"number"!=typeof we||He?void 0:we,role:Ne&&"combobox","aria-label":Ee||D,"aria-invalid":de&&"error"===de.status||ot,"aria-owns":Ne,"aria-activedescendant":ge,"aria-required":_e,"aria-describedby":ht,required:_e,tabIndex:Ve,dir:$e}),Ke&&a.createElement("div",{className:o(F.loaderContainer,t({},F.loaderContainerHasIcon,bt))},a.createElement("div",{className:o(F.loader)},a.createElement(u,{className:o(F.loaderSvg)}))),a.createElement(L,{content:Et?Qe:void 0,referenceWrapperClassName:F.tooltipContainer},a.createElement(N,{className:o(F.iconContainer,t(t(t({},F.iconContainerHasIcon,bt),F.iconContainerActive,Et),F.iconContainerClickable,gt)),onClick:ft,tabIndex:Tt?"0":"-1",ariaLabel:It},a.createElement(m,{icon:te,className:o(F.icon),iconType:"font",iconSize:"small"===se?"16px":"18px"}))),a.createElement(L,{content:yt?Ze:void 0,addKeyboardHideShowTriggersByDefault:!0,referenceWrapperClassName:F.tooltipContainer},a.createElement(N,{className:o(F.iconContainer,t(t(t({},F.iconContainerHasIcon,bt),F.iconContainerActive,yt),F.iconContainerClickable,gt)),onClick:ft,tabIndex:Nt?"0":"-1","data-testid":Pe||h(I.TEXT_FIELD_SECONDARY_BUTTON,ne),ariaLabel:jt},a.createElement(m,{icon:oe,className:o(F.icon),iconType:"font",iconSize:"small"===se?"16px":"18px"})))),xt&&a.createElement(p,{type:"text2",color:"secondary",className:o(F.subTextContainer)},de&&de.text&&a.createElement("span",{className:o(F.subTextContainerStatus)},ot?Be:de.text),ye&&a.createElement("span",{className:o(F.counter),"aria-label":y.CHAR},ut&&ut.length||0,"number"==typeof we&&"/".concat(we),a.createElement(k,{id:ht,text:"Maximum of ".concat(we," characters")})))))})),{sizes:E,feedbacks:f,types:C});export{D as default};
//# sourceMappingURL=TextField.js.map
