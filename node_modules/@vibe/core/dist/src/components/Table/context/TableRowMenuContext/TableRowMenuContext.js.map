{"version":3,"file":"TableRowMenuContext.js","sources":["../../../../../../src/components/Table/context/TableRowMenuContext/TableRowMenuContext.tsx"],"sourcesContent":["import React, { createContext, useCallback, useContext, useMemo, useRef, useState } from \"react\";\nimport { TableRowMenuContext as ITableRowMenuContext, TableRowMenuProviderProps } from \"./TableRowMenuContext.types\";\n\nconst TableRowMenuContext = createContext<ITableRowMenuContext | undefined>(undefined);\n\nexport const TableRowMenuProvider = ({ value, children }: TableRowMenuProviderProps) => {\n  const { tableRootRef, hoveredRowRef, isMenuOpen, resetHoveredRow, setHoveredRowRef, setIsMenuOpen } = value;\n  const rowMouseLeaveTimeoutId = useRef<ReturnType<typeof setTimeout>>(null);\n  const [menuButtonPosition, setMenuButtonPosition] = useState(0);\n  const hasMenuRef = useRef<boolean | null>(null);\n\n  const resetTimeout = useCallback(() => {\n    clearTimeout(rowMouseLeaveTimeoutId.current);\n    rowMouseLeaveTimeoutId.current = null;\n  }, []);\n\n  const onMouseOverRow = useCallback(\n    (rowRef: React.RefObject<HTMLDivElement>) => {\n      if (hasMenuRef.current === false || isMenuOpen || hoveredRowRef?.current === rowRef.current) return;\n\n      resetTimeout();\n      setHoveredRowRef(rowRef);\n      const tableRootTop = tableRootRef.current.getBoundingClientRect().top;\n      const rowTop = rowRef.current.getBoundingClientRect().top;\n      setMenuButtonPosition(rowTop - tableRootTop);\n      if (hasMenuRef.current === null) {\n        setTimeout(() => {\n          hasMenuRef.current = !!document?.querySelector(`[data-row-menu-id]`);\n        });\n      }\n    },\n    [isMenuOpen, hoveredRowRef, resetTimeout, setHoveredRowRef, tableRootRef]\n  );\n\n  const onMouseLeaveRow = useCallback(() => {\n    if (isMenuOpen) return;\n    rowMouseLeaveTimeoutId.current = setTimeout(() => {\n      setHoveredRowRef(null);\n    }, 400);\n  }, [isMenuOpen, setHoveredRowRef]);\n\n  const onMouseOverRowMenu = useCallback(() => {\n    if (isMenuOpen) return;\n    resetTimeout();\n  }, [isMenuOpen, resetTimeout]);\n\n  const onMouseLeaveRowMenu = useCallback(() => {\n    if (isMenuOpen) return;\n    setHoveredRowRef(null);\n  }, [isMenuOpen, setHoveredRowRef]);\n\n  const contextValue = useMemo<ITableRowMenuContext>(\n    () => ({\n      hoveredRowId: hoveredRowRef?.current?.id,\n      resetHoveredRow,\n      menuButtonPosition,\n      onMouseOverRow,\n      onMouseLeaveRow,\n      onMouseOverRowMenu,\n      onMouseLeaveRowMenu,\n      setTableMenuShown: () => setIsMenuOpen(true),\n      setTableMenuHidden: () => setIsMenuOpen(false)\n    }),\n    [\n      hoveredRowRef,\n      resetHoveredRow,\n      menuButtonPosition,\n      onMouseLeaveRow,\n      onMouseLeaveRowMenu,\n      onMouseOverRow,\n      onMouseOverRowMenu,\n      setIsMenuOpen\n    ]\n  );\n\n  return <TableRowMenuContext.Provider value={contextValue}>{children}</TableRowMenuContext.Provider>;\n};\n\nexport const useTableRowMenu = () => {\n  const context = useContext(TableRowMenuContext);\n  if (!context) {\n    throw new Error(\"useTableRowMenuContext must be used within a TableRowMenuProvider\");\n  }\n  return context;\n};\n"],"names":["TableRowMenuContext","createContext","undefined","TableRowMenuProvider","_ref","value","children","tableRootRef","hoveredRowRef","isMenuOpen","resetHoveredRow","setHoveredRowRef","setIsMenuOpen","rowMouseLeaveTimeoutId","useRef","_useState","useState","_useState2","_slicedToArray","menuButtonPosition","setMenuButtonPosition","hasMenuRef","resetTimeout","useCallback","clearTimeout","current","onMouseOverRow","rowRef","tableRootTop","getBoundingClientRect","top","rowTop","setTimeout","document","querySelector","onMouseLeaveRow","onMouseOverRowMenu","onMouseLeaveRowMenu","contextValue","useMemo","hoveredRowId","_a","id","setTableMenuShown","setTableMenuHidden","React","createElement","Provider","useTableRowMenu","context","useContext","Error"],"mappings":"sMAGA,IAAMA,EAAsBC,OAAgDC,GAE/DC,EAAuB,SAAHC,GAAsD,IAAhDC,EAAKD,EAALC,MAAOC,EAAQF,EAARE,SACpCC,EAA8FF,EAA9FE,aAAcC,EAAgFH,EAAhFG,cAAeC,EAAiEJ,EAAjEI,WAAYC,EAAqDL,EAArDK,gBAAiBC,EAAoCN,EAApCM,iBAAkBC,EAAkBP,EAAlBO,cAC9EC,EAAyBC,EAAsC,MACrEC,EAAoDC,EAAS,GAAEC,EAAAC,EAAAH,EAAA,GAAxDI,EAAkBF,EAAA,GAAEG,EAAqBH,EAAA,GAC1CI,EAAaP,EAAuB,MAEpCQ,EAAeC,GAAY,WAC/BC,aAAaX,EAAuBY,SACpCZ,EAAuBY,QAAU,IAClC,GAAE,IAEGC,EAAiBH,GACrB,SAACI,GACC,IAA2B,IAAvBN,EAAWI,UAAqBhB,IAAcD,eAAAA,EAAeiB,WAAYE,EAAOF,QAApF,CAEAH,IACAX,EAAiBgB,GACjB,IAAMC,EAAerB,EAAakB,QAAQI,wBAAwBC,IAC5DC,EAASJ,EAAOF,QAAQI,wBAAwBC,IACtDV,EAAsBW,EAASH,GACJ,OAAvBP,EAAWI,SACbO,YAAW,WACTX,EAAWI,WAAoB,OAARQ,eAAQ,IAARA,cAAQ,EAARA,SAAUC,cAAkC,sBACrE,GAV2F,CAY/F,GACA,CAACzB,EAAYD,EAAec,EAAcX,EAAkBJ,IAGxD4B,EAAkBZ,GAAY,WAC9Bd,IACJI,EAAuBY,QAAUO,YAAW,WAC1CrB,EAAiB,KAClB,GAAE,KACL,GAAG,CAACF,EAAYE,IAEVyB,EAAqBb,GAAY,WACjCd,GACJa,GACF,GAAG,CAACb,EAAYa,IAEVe,EAAsBd,GAAY,WAClCd,GACJE,EAAiB,KACnB,GAAG,CAACF,EAAYE,IAEV2B,EAAeC,GACnB,iBAAM,MAAC,CACLC,aAAoC,QAAtBC,EAAAjC,eAAAA,EAAeiB,eAAO,IAAAgB,OAAA,EAAAA,EAAEC,GACtChC,gBAAAA,EACAS,mBAAAA,EACAO,eAAAA,EACAS,gBAAAA,EACAC,mBAAAA,EACAC,oBAAAA,EACAM,kBAAmB,WAAA,OAAM/B,GAAc,EAAK,EAC5CgC,mBAAoB,WAAA,OAAMhC,GAAc,EAAM,KAEhD,CACEJ,EACAE,EACAS,EACAgB,EACAE,EACAX,EACAU,EACAxB,IAIJ,OAAOiC,EAAAC,cAAC9C,EAAoB+C,SAAQ,CAAC1C,MAAOiC,GAAehC,EAC7D,EAEa0C,EAAkB,WAC7B,IAAMC,EAAUC,EAAWlD,GAC3B,IAAKiD,EACH,MAAUE,MAAM,qEAElB,OAAOF,CACT"}